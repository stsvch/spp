# SPP Project

## Файлы задач

- Для каждой задачи можно загружать произвольные вложения. После загрузки бинарные данные попадают в MongoDB в GridFS-бакет `taskAttachments`, поэтому никакого файлового хранилища на диске не требуется.
- Метаданные (имя, размер, MIME-тип и связи с проектом/задачей) сохраняются в коллекции `files`. Это позволяет находить вложения, выдавать ссылки и синхронно очищать их вместе с задачами или проектами.
- Передача файла от клиента к серверу происходит в виде base64-представления внутри JSON-запроса. Такой подход выбран, чтобы не подтягивать дополнительные зависимости для разбора `multipart/form-data` и использовать уже настроенную `fetch`-обёртку. Размер файла ограничен 10 МБ, что комфортно укладывается в лимит документа MongoDB и не мешает потоковой отдаче.
- При скачивании сервер читает поток из GridFS и выставляет корректные заголовки `Content-Type` и `Content-Disposition`, поэтому клиенты скачивают файл с оригинальным именем.

Удаление задач и проектов автоматически удаляет связанные записи и бинарные данные из GridFS, так что «висячие» чанки не остаются.
